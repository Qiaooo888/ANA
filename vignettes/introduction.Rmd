---
title: "Introduction to ana Package"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to ana Package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(ana)
```

## Overview

The `ana` package provides comprehensive tools for exploratory data analysis in R. It includes functions for:

- Automatic statistical analysis (`ana()`)
- Visualization (`alook()`)
- Variable overview (`avar()`)
- Survival time calculations (multiple optimized versions)

## Basic Usage

### Data Analysis with `ana()`

The `ana()` function automatically detects variable types and provides appropriate statistics:

```{r}
# Using the built-in iris dataset
data(iris)

# Analyze specific variables
ana(iris, "Sepal.Length", "Species")
```

If you don't specify variables, `ana()` will automatically select up to 10 suitable variables:

```{r}
# Automatic variable selection
ana(iris)
```

### Visualization with `alook()`

The `alook()` function creates appropriate visualizations based on variable types:

```{r, fig.width=7, fig.height=5}
# Visualize specific variables
alook(iris, "Sepal.Length", "Species")
```

### Variable Overview with `avar()`

Get a comprehensive overview of all variables in your dataset:

```{r}
avar(iris)
```

## Survival Time Analysis

The package includes multiple implementations of survival time calculation, optimized for different scenarios:

### Basic Implementation

```{r}
# Create example longitudinal data
set.seed(123)
survival_data <- data.frame(
  patient_id = rep(1:50, each = 5),
  visit_time = rep(0:4, 50) + runif(250, -0.1, 0.1),
  event = rbinom(250, 1, 0.1)
)

# Calculate survival times
result <- a_survival_time_improved(
  survival_data,
  id_var = "patient_id",
  time = "visit_time",
  event = "event"
)

# View results for first patient
head(subset(result, patient_id == 1))
```

### Performance Comparison

For large datasets, consider using optimized versions:

- `a_survival_time_dt()`: 5-10x faster using data.table
- `a_survival_time_rcpp()`: 10-20x faster using C++
- `a_survival_time_parallel()`: Best for many individuals
- `a_survival_time_memory()`: For memory-constrained environments

## Handling Missing Values

The package handles missing values gracefully:

```{r}
# Create data with missing values
test_data <- data.frame(
  numeric_var = c(1, 2, NA, 4, 5),
  factor_var = factor(c("A", "B", NA, "B", "A")),
  char_var = c("hello", NA, "world", "test", NA)
)

# Analysis handles missing values automatically
ana(test_data)
```

## Tips for Large Datasets

1. For datasets with >100,000 rows, use `a_survival_time_dt()` or `a_survival_time_rcpp()`
2. For datasets with >10,000 individuals, consider `a_survival_time_parallel()`
3. Use `verbose = FALSE` to suppress messages for cleaner output
4. The `alook()` function works best with datasets under 10,000 rows

## Troubleshooting

If you encounter issues:

1. Ensure all dependencies are installed:
```{r, eval=FALSE}
install.packages(c("haven", "ggplot2", "dplyr", "scales", 
                   "knitr", "rmarkdown", "data.table", "Rcpp"))
```

2. For survival functions, check that your data has:
   - A unique identifier column
   - A numeric time column
   - An event indicator (0/1)

3. For visualization issues, check your graphics device:
```{r, eval=FALSE}
# Reset graphics device if needed
dev.off()
```

## Further Reading

- For detailed function documentation, use `?ana`, `?alook`, etc.
- Check GitHub repository for latest updates and bug reports
- Submit issues at: https://github.com/username/ana/issues